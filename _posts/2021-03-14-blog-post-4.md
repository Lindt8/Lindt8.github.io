---
title: 'Interactive world data map generation tool'
date: 2021-02-27
header-img: "images/default-site-banner-image_v1.png"
permalink: /posts/interactive-world-data-map-tool/
tags:
  - world map
  - Python
  - interactive
  - data
  - binned
  - SVG
---



<hr>

This page serves to discuss the usage and behaviors of the [Interactive world data map generator](https://github.com/Lindt8/Interactive_world_data_map) tool that I wrote.  The GitHub page's README covers required packages and very basic usage, so this page seeks to take a deeper look at the intended input formats and settings, the logic behind some of the code's options, and how the maps generated by this code differ from those generated by the base Pygal library which this code uses.


<hr>

<!--
Add to <svg> tag:
viewBox="0 100 800 400" preserveAspectRatio="xMidYMid meet" width="100%" height="100%"
-->

The code serves to easily create interactive world maps such as the one below showing the number of [Olympic medals won](https://en.wikipedia.org/wiki/All-time_Olympic_Games_medal_table) by each country.  It takes as input data in an Excel spreadsheet, a .csv (comma separated values) file, or a .tsv (tab separated values) file.  (All other formats provided are assumed to be CSV files.)  It outputs the Scalable Vector Graphics (SVG) file containing the map and an HTML file with the map embedded along with a table of all of the data on the map.

<div class="fluid-width-video-wrapper" style="padding-top: 75%; text-align: center;"><embed src="/files/Olympic_medals_per_country.svg" type=""></div>

### Basic operation

When the code is ran, the GUI shown below will pop up (but with default entries).  This article will discuss these various settings.

<p align="center"><img src="/files/world-map-tool/map_gui_medals.png"></p>

The default value of "Input file" will be either a user-provided file path if the code detects a file titled "default_path_to_data_file.txt" in the working directory or will default to "default.xlsx" in the current working directory.  A different file can be selected using the Browse button or by manually entering a new path.  When the code is ran for the first time for a given input file (or if the input file has been updated since the last time the code was ran), the code will carefully parse the file and print diagnostic information to the screen, allowing you to check if the listed countries are being properly identified.  If "Run" is selected, the window will close and this information is printed to the terminal as usual; if "Run (keep window open)" is selected, a popup window (shown below) to which the terminal output is redirected will appear.  

<p align="center"><img src="/files/world-map-tool/terminal_output.png"></p>

Keeping the window open can be useful for trying different colors and settings quickly.  After the file has been carefully parsed, its data and the GUI's settings are saved to a file of the same name as the input data file but ending with the ``.pickle`` extension instead.  Then, in future cases when the code is ran, if it discovers that this pickle file is present in the same folder as the source data file and that the source data file has not been modified since the pickle was created or last updated, the code will use the data stored in the pickle file instead of rereading the source data file, speeding it up notably.  Additionally, any time the code is ran and the corresponding pickle file is discovered, the GUI will automatically change its settings to match those used the last time the pickle file was updated, and any new or modified settings will be saved to the pickle file for future iterations.  For Excel spreadsheet files, you can select data from any of its sheets, and the pickle file will independently save the data from and GUI settings used for each sheet.  Updating the Input file or the sheet name causes the code to search for the pickle file and to update the GUI if found.

### Tallied vs Untallied data

The most important option provided by the code is the type of data: tallied or untallied.  Tallied data is presented as a list of countries with values already assigned (population per country, [Olympic medals won per country](https://en.wikipedia.org/wiki/All-time_Olympic_Games_medal_table) as shown at the top of this page, etc.) and would be in a spreadsheet/data file tabulated as shown below.  In this case, the code needs to know the column numbers for both where the country names are listed and where the data values are listed.  If a country is identified multiple times, the values from each are summed; for instance, in this example the number of medals for Germany includes those from "Germany", "West Germany", "East Germany", and the "Unified Team of Germany".

| Country  |  Total medals won (Summer + Winter Games)   |
| -------- | ----------- |
| United States | 2828 |
| Russia (and Soviet Union) | 1776 |
| Germany (modern, East, West, and United Team of) | 1754 |
| United Kingdom (Great Britain) | 883 |
| France | 840 |

Untallied data consists of just a list of countries, and the number of appearances of each country is counted.  This would be useful if you hosted an international event, had a list of all of the attendees and their countries, and wanted to make a map illustrating how many attendees you had from each country.  


<div class="fluid-width-video-wrapper" style="padding-top: 75%; text-align: center;"><embed src="/files/world-map-tool/Olympic_events_per_country.svg" type=""></div>


The code also always needs to know how many header rows there are (top rows which will be skipped).



| Binning Logic  | |    |
| -------- | ----------- | ----------- |
|   | add overflow bin = ``True`` |  add overflow bin = ``False`` |
| force integer bin edges = ``True``  |  First bin: [V_lower,V_upper]<br>Mid bins: [V_lower+1,V_upper]<br>Last bin: [V_lower+1,V_upper]<br>Overflow bin: [V_upper+1,inf)  |	First bin: [V_lower,V_upper]<br>Mid bins: [V_lower+1,V_upper]<br>Last bin: [V_lower+1,V_upper]<br>Overflow bin: n/a    |
| force integer bin edges = ``False``	|	 First bin: [V_lower,V_upper]<br>Mid bins: [V_lower+1,V_upper]<br>Last bin: [V_lower+1,V_upper)<br>Overflow bin: [V_upper,inf)   |	 First bin: [V_lower,V_upper]<br>Mid bins: (V_lower,V_upper]<br>Last bin: (V_lower,V_upper]<br>Overflow bin: n/a   |
{: .tablelines}

### How do these maps differ from those made with stock Pygal?

<div class="fluid-width-video-wrapper" style="padding-top: 75%; text-align: center;"><embed src="/files/world-map-tool/Pygal_only_medals-map.svg" type=""></div>
